<!DOCTYPE html>
<html lang="ko"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="admin/inc/layout-back">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/vanillajs-datepicker@1.3.4/dist/css/datepicker.min.css">
    <script src="https://cdn.jsdelivr.net/npm/vanillajs-datepicker@1.3.4/dist/js/datepicker-full.min.js"> </script>

    <script>
        window.addEventListener("load", function () {
            const dropdownButtonCategory = document.getElementById("dropdown-btn-category");
            const dropdownListCategory = document.getElementById("dropdown-list-category");

            dropdownButtonCategory.addEventListener("click", function () {
                dropdownListCategory.classList.toggle("active");
            });
        });
        window.addEventListener("load", function () {
            const dropdownButtonKeepcase = document.getElementById("dropdown-btn-keepcase");
            const dropdownListKeepcase = document.getElementById("dropdown-list-keepcase");

            dropdownButtonKeepcase.addEventListener("click", function () {
                dropdownListKeepcase.classList.toggle("active");
            });
        });

    </script>
    <style>
        li {
            list-style: none;
        }

        img {
            width: 90px;
            height: 90px;
        }

        .real-upload {
            display: none;
        }

        .upload {
            position: relative;
            display: inline-flex;
        }

        .upload::before {
            content: url(/icon/camera.svg);
            position: absolute;
            top: 50%;
            transform: translateY(-50%);


            margin-right: 100px; /* 이미지와 텍스트 간격 조정 */
        }

        .text {
            padding-left: 25px; /* 이미지 너비 + 간격만큼 텍스트를 이동시킴 */
        }



        .image-preview {
            width: 1300px;
            height: 90px;
            background-color: #FFFFFF;
            display: flex;
            gap: 20px;
        }

        .input-wrapper {
            display: flex;
            align-items: center; /* 입력 필드와 버튼을 수직 중앙 정렬합니다. */
        }

        .input-wrapper input {
            flex: 1; /* 입력 필드가 가능한 한 많은 공간을 차지하도록 설정합니다. */
            margin-right: 8px; /* 입력 필드와 버튼 사이의 간격을 조절합니다. */
        }
    </style>
</head>

<body>
<main class= "main-admin pc:680" layout:fragment="main">
    <section class= "m-side">
        <h1 class="d:none">상품 정보</h1>
        <form class="n-form:outline-none d:flex fl-dir:column gap:8">
            <div class="n-dropdown">
                <button id="dropdown-btn-category" type="button" class="n-btn n-btn:outline min-w:5 jc:space-between">
                    <span class="fl:fill">카테고리 선택</span><span class="icon icon:RT icon-size:1 icon-color:main-6"></span></button>

                <ul id="dropdown-list-category">
                    <li>과채류</li>
                    <li>양념류</li>
                    <li>가공식품류</li>
                </ul>
            </div>
            <fieldset class ="d:flex fl-dir:column gap:8">
                <legend class="d:none">상품 설명 텍스트</legend>
                <div >
                    <span>상품명</span>
                    <input
                            type="text"
                            class="n-textbox n-textbox-type:underline"
                            value="배추"/>
                </div>
                <div>
                    <span>가격</span>
                    <input
                            type="text"
                            class="n-textbox n-textbox-type:underline"
                            value="10,000원"/>
                </div>
                <div>
                    <span>중량</span>
                    <input
                            type="text"
                            class="n-textbox n-textbox-type:underline"
                            value="2kg"/>
                </div>
                <div>
                    <span>개수</span>
                    <input
                            type="text"
                            class="n-textbox n-textbox-type:underline"
                            value="2개입"/>
                </div>
                <div>
                    <span>재고</span>
                    <input
                            type="text"
                            class="n-textbox n-textbox-type:underline"
                            value="100개"/>
                </div>
                <div class="d:flex fl-dir:column">
                    <span>수확일</span>
                    <div class="input-wrapper">
                        <input type="text" class="n-textbox n-textbox-type:underline" name="foo2" value="01/01/2024">
                        <button><img src="/icon/calendar.svg" alt="달력 아이콘" class="calendar-icon" style="width: 32px; height: 32px;"></button>
                    </div>
                    <script>
                        const button = document.querySelector('.calendar-icon');
                        button.addEventListener('click', function()
                        {
                            const input = document.querySelector('input[name="foo2"]');
                            const datepicker = new Datepicker(input, {});
                            datepicker.show();
                        });
                    </script>
                </div>
                <div>
                    <span>유통기한</span>
                    <div>
                        <div id="foo" class="d:flex fl-dir:row ">
                            <input type="text" class="n-textbox n-textbox-type:underline" name="start" value="01/01/2024">
                            <button><img src="/icon/calendar.svg" alt="달력 아이콘" class="calendar-icon" style="width: 32px; height: 32px;"></button>
                            <span>~</span>
                            <input type="text" class="n-textbox n-textbox-type:underline" name="end" value="01/02/2024">
                            <button><img src="/icon/calendar.svg" alt="달력 아이콘" class="calendar-icon" style="width: 32px; height: 32px;"></button>
                        </div>
                    </div>
                    <script>
                        const elem = document.getElementById('foo');
                        const rangepicker = new DateRangePicker(elem, {
                            // ...options
                        });
                    </script>
                </div>
                <div class="n-dropdown">
                    <label class="d:flex fl-dir:column gap:2">상품보관유형
                        <button id="dropdown-btn-keepcase" type="button" class="n-btn n-btn:outline max-w:5 jc:space-between">
                            <span class="flex:fill">보관유형선택</span><span class="icon icon:RT icon-size:1 icon-color:main-6"></span></button>
                    </label>
                    <ul id="dropdown-list-keepcase">
                        <li>실온보관</li>
                        <li>냉장보관</li>
                        <li>냉동보관</li>
                    </ul>
                </div>
                <div>
                    <span>상품설명</span>
                    <textarea type="text" class="n-textbox"></textarea>
                </div>
            </fieldset>
            <div>
                <ul class="image-preview"></ul>
                <input type="file" class="real-upload" accept="image/*" required multiple>
                <div class="upload n-btn w:100p"><span class="text">사진 첨부하기</span></div>
                <script>
                    function getImageFiles(e) {
                        const uploadFiles = [];
                        const files = e.currentTarget.files;
                        const imagePreview = document.querySelector('.image-preview');
                        const docFrag = new DocumentFragment();

                        const uploadedImagesCount = imagePreview.querySelectorAll('li').length;

                        if (uploadedImagesCount + files.length > 4) {
                            alert('이미지는 최대 4개 까지 업로드가 가능합니다.');
                            return;
                        }


                        // 파일 타입 검사
                        [...files].forEach(file => {
                            if (!file.type.match("image/.*")) {
                                alert('이미지 파일만 업로드가 가능합니다.');
                                return
                            }

                            // 파일 갯수 검사
                            if ([...files].length < 4) {
                                uploadFiles.push(file);
                                const reader = new FileReader();
                                reader.onload = (e) => {
                                    const preview = createElement(e, file);
                                    imagePreview.appendChild(preview);
                                };
                                reader.readAsDataURL(file);
                            }
                        });
                    }

                    function createElement(e, file) {
                        const li = document.createElement('li');
                        const img = document.createElement('img');
                        img.setAttribute('src', e.target.result);
                        img.setAttribute('data-file', file.name);
                        li.appendChild(img);

                        const removeBtn = document.createElement('span');
                        removeBtn.innerText = 'x';
                        removeBtn.classList.add('remove-btn');
                        removeBtn.addEventListener('click', () => removeImage(li));
                        li.appendChild(removeBtn);


                        return li;
                    }

                    function removeImage(li) {
                        li.parentNode.removeChild(li);
                    }

                    const realUpload = document.querySelector('.real-upload');
                    const upload = document.querySelector('.upload');

                    upload.addEventListener('click', () => realUpload.click());

                    realUpload.addEventListener('change', getImageFiles);
                </script>

            </div>
            <div>
                <span>상태</span>
                <input type="checkbox" class="n-toggle n-toggle-type:slide"/>
            </div>
            <div class = "display:flex flex-direction:row w:100p gap:8">
                <button type="button" class="n-btn n-btn-color:accent  n-btn-size:2 min-w:3 w:100p">삭제</button>
                <button type="button" class="n-btn n-btn-size:2 min-w:3 w:100p">저장</button>
            </div>
        </form>
    </section>
</main>
</body>

</html>
